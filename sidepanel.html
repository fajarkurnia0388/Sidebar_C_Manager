<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Cursor Account Manager - Sidebar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="sidepanel-modern.css" />
  </head>
  <body>
    <div id="sidebar-app">
      <!-- Header with Modern Gradient -->
      <div class="sidebar-header">
        <div class="title">
          <span class="icon">🛡️</span>
          <h2>Cursor Manager Pro</h2>
        </div>
        <div class="header-actions">
          <button id="darkModeToggle" class="icon-btn" title="Toggle Dark Mode">
            🌙
          </button>
          <button id="refreshBtn" class="icon-btn" title="Refresh">🔄</button>
        </div>
      </div>

      <!-- Debug Panel (Hidden by default) -->
      <div class="debug-section">
        <button
          id="debugToggle"
          class="btn btn-link btn-sm debug-toggle"
          style="display: none"
          title="Toggle Debug Panel (Ctrl+Shift+D)"
        >
          🐛 Debug
        </button>
        <div id="debugPanel" class="debug-panel" style="display: none">
          <h3>Debug Tools</h3>
          <div class="debug-actions">
            <button id="showStoredDataBtn" class="btn btn-secondary btn-sm">
              📄 Show Data
            </button>
            <button id="clearAllDataBtn" class="btn btn-danger btn-sm">
              🗑️ Clear All
            </button>
            <button
              id="consolidateDuplicatesBtn"
              class="btn btn-secondary btn-sm"
            >
              🔧 Fix Duplicates
            </button>
          </div>
          <div id="debugOutput" class="debug-output"></div>
        </div>
      </div>

      <!-- Current Account Section -->
      <div class="current-account-section">
        <div class="current-label">Active Account</div>
        <div class="current-account" id="currentAccount">
          <span class="account-icon">🔴</span>
          <div class="account-details">
            <span class="account-name">Not logged in</span>
            <span class="account-status"></span>
          </div>
        </div>
      </div>

      <!-- Tab Navigation with Bypass Testing -->
      <div class="tab-navigation navbar">
        <button id="accountsTab" class="tab-btn active">👤 Accounts</button>
        <button id="paymentsTab" class="tab-btn">💳 Cards</button>
        <button id="generatorTab" class="tab-btn">🎲 Generator</button>
        <button id="bypassTab" class="tab-btn">🛡️ Bypass</button>
      </div>

      <!-- Accounts Tab Content -->
      <div id="accountsContent" class="tab-content">
        <!-- Quick Actions -->
        <div class="quick-actions">
          <button id="addAccountBtn" class="btn btn-primary btn-sm">
            ➕ Add Account
          </button>
          <button id="exportCurrentBtn" class="btn btn-secondary btn-sm">
            💾 Export
          </button>
          <button id="importFromDownloadsBtn" class="btn btn-secondary btn-sm">
            📁 Import Files
          </button>
          <button id="refreshStatusBtn" class="btn btn-success btn-sm">
            🔄 Refresh Status
          </button>
          <button id="toggleAdvancedBtn" class="btn btn-link btn-sm">
            ⚙️ Advanced Tools
          </button>
        </div>

        <!-- Advanced Actions (collapsible) -->
        <div class="advanced-actions">
          <div id="advancedPanel" class="advanced-panel" style="display: none">
            <button id="importFolderBtn" class="btn btn-secondary btn-sm">
              📂 Import Folder
            </button>
            <button
              id="consolidateDuplicatesBtn"
              class="btn btn-secondary btn-sm"
            >
              🔧 Fix Duplicates
            </button>
            <button id="clearAllDataBtn" class="btn btn-danger btn-sm">
              🗑️ Clear All Data
            </button>
            <hr style="margin: 8px 0; border: 1px solid var(--border-color)" />
            <button id="deleteFreeAccountBtn" class="btn btn-danger btn-sm">
              💀 Delete Free Account
            </button>
            <button id="deleteProTrialAccountBtn" class="btn btn-danger btn-sm">
              ⚡ Delete Pro Trial Account
            </button>
          </div>
        </div>

        <!-- Accounts List -->
        <div class="accounts-section">
          <div class="section-header">
            <h3>Accounts</h3>
            <span id="accountsCount" class="count">(0)</span>
          </div>

          <!-- Account Filters -->
          <div class="account-filters">
            <div class="filter-row">
              <input
                type="text"
                id="accountFilterInput"
                placeholder="Filter accounts by name, email..."
                class="filter-input"
              />
              <select id="accountStatusFilter" class="filter-select">
                <option value="">All Status</option>
                <option value="free">Free</option>
                <option value="pro trial">Pro Trial</option>
                <option value="pro plan">Pro Plan</option>
                <option value="business">Business</option>
                <option value="empty">Empty Status</option>
              </select>
            </div>
          </div>

          <div id="accountsList" class="sidebar-accounts-list scrollable">
            <!-- Accounts will be populated here -->
          </div>

          <div id="noAccounts" class="empty-state" style="display: none">
            <div class="empty-icon">📁</div>
            <p>No accounts</p>
            <p class="hint">Click ➕ to add</p>
          </div>
        </div>
      </div>

      <!-- Payments Tab Content -->
      <div id="paymentsContent" class="tab-content" style="display: none">
        <!-- Payment Controls -->
        <div class="controls-section">
          <button id="importCardsBtn" class="btn btn-primary btn-sm">
            ➕ Import Cards
          </button>
          <button id="exportCardsBtn" class="btn btn-success btn-sm">
            📤 Export Cards
          </button>
          <button id="findPaymentFieldsBtn" class="btn btn-secondary btn-sm">
            🔍 Find Fields
          </button>
          <button id="clearCardsBtn" class="btn btn-danger btn-sm">
            🗑️ Clear All
          </button>
        </div>

        <!-- Payment Cards List -->
        <div class="cards-section">
          <div class="section-header">
            <h3>Payment Cards</h3>
            <span class="cards-count" id="cardsCount">(0)</span>
          </div>

          <!-- Card Filters and Bulk Actions -->
          <div class="card-filters">
            <div class="filter-row">
              <input
                type="text"
                id="cardFilterInput"
                placeholder="Filter cards by number, type, expiry..."
                class="filter-input"
              />
              <select id="cardTypeFilter" class="filter-select">
                <option value="">All Types</option>
                <option value="visa">Visa</option>
                <option value="mastercard">MasterCard</option>
                <option value="american express">American Express</option>
                <option value="discover">Discover</option>
                <option value="unknown">Unknown</option>
              </select>
            </div>

            <div class="bulk-actions" id="bulkActions" style="display: none">
              <label class="select-all-container">
                <input type="checkbox" id="selectAllCards" />
                <span>Select All</span>
              </label>
              <button id="deleteSelectedBtn" class="btn btn-danger btn-sm">
                🗑️ Delete Selected (<span id="selectedCount">0</span>)
              </button>
              <button id="clearSelectionBtn" class="btn btn-secondary btn-sm">
                ✖️ Clear Selection
              </button>
            </div>
          </div>

          <div id="cardsList" class="cards-list scrollable">
            <!-- Cards will be populated here -->
          </div>

          <div id="noCards" class="empty-state" style="display: none">
            <div class="empty-icon">💳</div>
            <p>No payment cards imported</p>
            <p class="hint">
              Click "Import Cards" to load card data from card.md files
            </p>
          </div>

          <!-- Payment Form Detection -->
          <div id="paymentFormInfo" class="form-info" style="display: none">
            <div class="info-header">Payment Form Detected</div>
            <div id="formFieldsInfo"></div>
          </div>
        </div>
      </div>

      <!-- Generator Tab Content -->
      <div id="generatorContent" class="tab-content" style="display: none">
        <!-- Payment Generator Panel -->
        <div class="generator-panel">
          <div class="panel-header">
            <h3>💳 Payment Data Generator</h3>
          </div>

          <div class="panel-content">
            <div class="settings-grid">
              <div class="settings-group">
                <label>BIN (Bank Identification Number):</label>
                <div class="bin-input-container">
                  <input
                    type="text"
                    id="binInput"
                    value="552461"
                    placeholder="e.g., 552461 or 5524xxxxxxxxx"
                    class="form-input"
                  />
                  <div
                    id="binHistoryDropdown"
                    class="bin-history-dropdown"
                    style="display: none"
                  >
                    <!-- BIN history items will be populated here -->
                  </div>
                </div>
              </div>

              <div class="settings-group">
                <label>Quantity:</label>
                <input
                  type="number"
                  id="cardQuantity"
                  min="1"
                  max="100"
                  value="10"
                  class="form-input"
                />
              </div>

              <div class="settings-group">
                <label>Month:</label>
                <select id="monthSelect" class="form-select">
                  <option value="Random">Random</option>
                  <option value="01">01</option>
                  <option value="02">02</option>
                  <option value="03">03</option>
                  <option value="04">04</option>
                  <option value="05">05</option>
                  <option value="06">06</option>
                  <option value="07">07</option>
                  <option value="08">08</option>
                  <option value="09">09</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select>
              </div>

              <div class="settings-group">
                <label>Year:</label>
                <select id="yearSelect" class="form-select">
                  <option value="Random">Random</option>
                  <option value="25">2025</option>
                  <option value="26">2026</option>
                  <option value="27">2027</option>
                  <option value="28">2028</option>
                  <option value="29">2029</option>
                  <option value="30">2030</option>
                  <option value="31">2031</option>
                  <option value="32">2032</option>
                  <option value="33">2033</option>
                </select>
              </div>
            </div>

            <div class="settings-group action-buttons">
              <button id="generateCardsBtn" class="btn btn-primary">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4Z"
                  />
                </svg>
                Generate Payment Data
              </button>
            </div>

            <div class="output-section">
              <label>Generated Payment Data:</label>
              <textarea
                id="cardOutput"
                readonly
                class="output-textarea"
                placeholder="Generated payment data will appear here..."
              ></textarea>
            </div>

            <div class="settings-grid">
              <div class="settings-group">
                <label>
                  <input type="checkbox" id="autoFillEnabled" checked />
                  Enable automatic form filling
                </label>
              </div>

              <div class="settings-group">
                <label>
                  <input type="checkbox" id="autoSubmitEnabled" />
                  Auto-submit forms after filling (be careful!)
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Address Generator Panel -->
        <div class="generator-panel">
          <div class="panel-header">
            <h3>🏠 Address & Name Generator</h3>
          </div>

          <div class="panel-content">
            <div class="settings-group">
              <label>Country:</label>
              <select id="countrySelect" class="form-select">
                <option value="US">United States</option>
                <option value="CA">Canada</option>
                <option value="GB">United Kingdom</option>
                <option value="DE">Germany</option>
                <option value="FR">France</option>
                <option value="AU">Australia</option>
              </select>
            </div>

            <div class="settings-group action-buttons">
              <button id="generateAddressBtn" class="btn btn-primary">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" />
                </svg>
                Generate Address & Name
              </button>
            </div>

            <div class="output-section">
              <label>Generated Address & Name:</label>
              <textarea
                id="personalOutput"
                readonly
                class="output-textarea"
                placeholder="Generated addresses and names will appear here..."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Pro Trial Activation Panel -->
        <div class="generator-panel">
          <div class="panel-header">
            <h3>🚀 Pro Trial Activation</h3>
          </div>

          <div class="panel-content">
            <div class="settings-group action-buttons">
              <button id="activateProTrialBtn" class="btn btn-success">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"
                  />
                </svg>
                Activate Pro Trial
              </button>
            </div>

            <div class="form-hint">
              <p><strong>Instructions:</strong></p>
              <p>1. Make sure you're logged into Cursor.com</p>
              <p>2. Click "Activate Pro Trial" to automatically:</p>
              <ul>
                <li>Generate valid payment data</li>
                <li>Navigate to trial activation page</li>
                <li>Fill payment form automatically</li>
                <li>Submit trial activation</li>
              </ul>
              <p>
                <strong>Note:</strong> This will use test payment data that may
                trigger validation but won't charge real cards.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- NEW: Bypass Testing Tab Content -->
      <div
        id="bypassContent"
        class="tab-content scrollable"
        style="display: none; overflow-y: auto; max-height: calc(100vh - 200px)"
      >
        <div class="bypass-section" style="padding: 16px">
          <div class="bypass-header">
            <div
              class="bypass-title"
              style="display: flex; align-items: center; gap: 12px"
            >
              <span class="icon">🛡️</span>
              <span>Bypass Security Tester</span>
              <span
                style="
                  background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
                  color: #1f2937;
                  padding: 2px 8px;
                  border-radius: 12px;
                  font-size: 10px;
                  font-weight: 600;
                  letter-spacing: 0.5px;
                  text-transform: uppercase;
                  box-shadow: 0 2px 4px rgba(251, 191, 36, 0.3);
                "
                >Under Development</span
              >
            </div>
          </div>

          <!-- Control Buttons -->
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 12px;
            "
          >
            <button
              id="bypassDetectUrl"
              class="btn btn-primary btn-sm"
              style="display: flex; align-items: center; gap: 6px"
            >
              <span>🎯</span> Detect URL
            </button>
            <button
              id="bypassSettingsBtn"
              class="btn btn-secondary btn-sm"
              style="display: flex; align-items: center; gap: 6px"
            >
              <span>⚙️</span> Settings
            </button>
          </div>

          <!-- Target Configuration -->
          <div class="bypass-controls">
            <div
              class="input-group"
              style="display: flex; gap: 8px; margin-bottom: 16px"
            >
              <input
                type="text"
                id="bypassTargetUrl"
                class="bypass-url-input filter-input"
                placeholder="https://cursor.com/api/dashboard/delete-account"
                style="flex: 1"
              />
            </div>
          </div>

          <!-- Action Buttons (Moved to Top) -->
          <div
            style="
              margin-bottom: 16px;
              padding: 12px;
              background: #1e293b;
              border-radius: 8px;
              border: 1px solid #334155;
            "
          >
            <div
              style="
                font-size: 13px;
                color: #cbd5e1;
                margin-bottom: 10px;
                font-weight: 600;
              "
            >
              Quick Actions
            </div>

            <!-- All Actions in One Row -->
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                gap: 8px;
              "
            >
              <button
                id="startBypassTest"
                type="button"
                style="
                  padding: 8px;
                  background: #3b82f6;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 12px;
                  font-weight: 500;
                  white-space: nowrap;
                "
              >
                ▶️ Start
              </button>
              <button
                id="stopBypassTest"
                type="button"
                disabled
                style="
                  padding: 8px;
                  background: #6b7280;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: not-allowed;
                  font-size: 12px;
                  font-weight: 500;
                  opacity: 0.5;
                  white-space: nowrap;
                "
              >
                ⏹️ Stop
              </button>
              <button
                id="exportBypassResults"
                type="button"
                style="
                  padding: 8px;
                  background: #1f2937;
                  color: white;
                  border: 1px solid #374151;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 12px;
                  font-weight: 500;
                  white-space: nowrap;
                "
              >
                💾 Export
              </button>
              <button
                id="viewBypassResults"
                type="button"
                style="
                  padding: 8px;
                  background: #10b981;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 12px;
                  font-weight: 500;
                  white-space: nowrap;
                "
              >
                📊 Results
              </button>
              <button
                id="openBypassConsole"
                type="button"
                style="
                  padding: 8px;
                  background: #8b5cf6;
                  color: white;
                  border: none;
                  border-radius: 4px;
                  cursor: pointer;
                  font-size: 12px;
                  font-weight: 500;
                  white-space: nowrap;
                "
              >
                🖥️ Console
              </button>
            </div>
          </div>

          <!-- Techniques Selection -->
          <div class="section-header" style="margin-top: 16px">
            <h3>Bypass Techniques</h3>
            <button id="bypassSelectAll" class="btn btn-link btn-sm">
              Select All
            </button>
          </div>

          <div class="bypass-techniques scrollable">
            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-param"
                data-technique="parameter"
                checked
              />
              <label for="tech-param" class="technique-label">
                Parameter Injection
              </label>
              <span class="technique-count">15 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-header"
                data-technique="header"
                checked
              />
              <label for="tech-header" class="technique-label">
                Header Manipulation
              </label>
              <span class="technique-count">15 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-method"
                data-technique="method"
                checked
              />
              <label for="tech-method" class="technique-label">
                Method Override
              </label>
              <span class="technique-count">20 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-content"
                data-technique="content"
                checked
              />
              <label for="tech-content" class="technique-label">
                Content-Type Bypass
              </label>
              <span class="technique-count">9 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-auth"
                data-technique="auth"
                checked
              />
              <label for="tech-auth" class="technique-label">
                Authorization Bypass
              </label>
              <span class="technique-count">6 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-storage"
                data-technique="storage"
                checked
              />
              <label for="tech-storage" class="technique-label">
                Storage Manipulation
              </label>
              <span class="technique-count">20 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-frontend"
                data-technique="frontend"
                checked
              />
              <label for="tech-frontend" class="technique-label">
                Frontend Override
              </label>
              <span class="technique-count">5 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-race"
                data-technique="race"
                checked
              />
              <label for="tech-race" class="technique-label">
                Race Condition
              </label>
              <span class="technique-count">10 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-encoding"
                data-technique="encoding"
                checked
              />
              <label for="tech-encoding" class="technique-label">
                Encoding Bypass
              </label>
              <span class="technique-count">9 tests</span>
            </div>

            <div class="technique-item">
              <input
                type="checkbox"
                id="tech-endpoint"
                data-technique="endpoint"
                checked
              />
              <label for="tech-endpoint" class="technique-label">
                Alternative Endpoints
              </label>
              <span class="technique-count">7 tests</span>
            </div>
          </div>

          <div
            id="bypassTotalTests"
            style="
              text-align: center;
              margin: 8px 0;
              color: var(--text-secondary);
              font-size: 12px;
            "
          >
            116 tests selected
          </div>

          <!-- Progress Section -->
          <div
            id="bypassProgressSection"
            class="bypass-progress"
            style="display: none"
          >
            <div class="progress-bar">
              <div
                class="progress-fill"
                id="bypassProgressFill"
                style="width: 0%"
              ></div>
            </div>
            <div class="progress-text" id="bypassProgressText">
              Initializing...
            </div>
          </div>

          <!-- Results Section -->
          <div
            id="bypassResultsSection"
            class="bypass-results"
            style="display: none"
          >
            <h3 style="margin-bottom: 12px">Test Results</h3>
            <div class="results-summary">
              <div class="result-stat success">
                <div class="result-value" id="bypassSuccessCount">0</div>
                <div class="result-label">Successful</div>
              </div>
              <div class="result-stat partial">
                <div class="result-value" id="bypassPartialCount">0</div>
                <div class="result-label">Partial</div>
              </div>
              <div class="result-stat failed">
                <div class="result-value" id="bypassFailedCount">0</div>
                <div class="result-label">Failed</div>
              </div>
            </div>
            <div
              id="bypassResultDetails"
              class="result-details"
              style="margin-top: 12px"
            >
              <!-- Detailed results will be populated here -->
            </div>
          </div>
        </div>
      </div>

      <!-- Loading Overlay -->
      <div id="loadingOverlay" class="loading-overlay" style="display: none">
        <div class="spinner"></div>
        <p>Loading...</p>
      </div>

      <!-- Notification -->
      <div id="notification" class="notification" style="display: none">
        <span id="notificationText"></span>
      </div>
    </div>

    <!-- Account Item Template -->
    <template id="sidebarAccountTemplate">
      <div class="sidebar-account-item" data-account="">
        <div class="account-info">
          <div class="account-avatar">
            <span class="account-icon">👤</span>
            <div class="active-indicator">✓</div>
          </div>
          <div class="account-details">
            <div class="account-email"></div>
            <div class="account-meta">
              <span class="account-status"></span>
            </div>
          </div>
        </div>
        <div class="account-actions">
          <button class="reveal-btn" title="Show file in folder">📁</button>
          <button class="delete-btn" title="Delete account">🗑️</button>
        </div>
      </div>
    </template>

    <!-- Card Item Template -->
    <template id="sidebarCardTemplate">
      <div class="card-item" data-card-id="">
        <div class="card-checkbox">
          <input type="checkbox" class="card-select" />
        </div>
        <div class="card-info">
          <div class="card-icon">
            <span class="card-type-icon">💳</span>
          </div>
          <div class="card-details">
            <div class="card-number"></div>
            <div class="card-meta">
              <span class="card-expiry"></span>
              <span class="card-type"></span>
            </div>
          </div>
        </div>
        <div class="card-actions">
          <button class="fill-btn" title="Auto-fill this card">✨</button>
          <button class="remove-card-btn" title="Remove card">🗑️</button>
        </div>
      </div>
    </template>

    <!-- Add Account Modal -->
    <div id="addAccountModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Add Account</h3>
          <button class="modal-close" id="closeModal">✕</button>
        </div>
        <div class="modal-body">
          <p>Paste your Cursor account cookies JSON here:</p>
          <textarea
            id="cookiesInput"
            rows="6"
            placeholder='[{"name": "SessionToken", "value": "...", ...}]'
          ></textarea>
          <div class="form-group">
            <label for="accountNameInput">Account Name (optional):</label>
            <input
              type="text"
              id="accountNameInput"
              placeholder="Auto-generated if empty"
            />
          </div>
        </div>
        <div class="modal-footer">
          <button id="confirmAddBtn" class="btn btn-primary">Add</button>
          <button id="cancelAddBtn" class="btn btn-secondary">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Bypass Settings Modal -->
    <div id="bypassSettingsModal" class="modal" style="display: none">
      <div class="modal-content" style="max-width: 600px">
        <div class="modal-header">
          <h3>🛡️ Bypass Testing Settings</h3>
          <button class="modal-close" id="closeBypassSettingsModal">✕</button>
        </div>
        <div class="modal-body" style="max-height: 400px; overflow-y: auto">
          <!-- URL Presets Section -->
          <div class="settings-section">
            <h4 style="margin-bottom: 12px; color: var(--text-primary)">
              URL Presets
            </h4>
            <div class="form-group">
              <label for="bypassPresetName">Preset Name:</label>
              <input
                type="text"
                id="bypassPresetName"
                placeholder="e.g., Cursor API"
              />
            </div>
            <div class="form-group">
              <label for="bypassPresetUrl">URL:</label>
              <input
                type="text"
                id="bypassPresetUrl"
                placeholder="https://cursor.com/api/endpoint"
              />
            </div>
            <button id="addBypassPreset" class="btn btn-secondary btn-sm">
              ➕ Add Preset
            </button>

            <div id="bypassPresetsList" style="margin-top: 12px">
              <!-- Presets will be populated here -->
            </div>
          </div>

          <hr style="margin: 20px 0; border: 1px solid var(--border-color)" />

          <!-- Advanced Options Section -->
          <div class="settings-section">
            <h4 style="margin-bottom: 12px; color: var(--text-primary)">
              Advanced Options
            </h4>
            <div class="form-group">
              <label for="bypassRequestDelay">Request Delay (ms):</label>
              <input
                type="number"
                id="bypassRequestDelay"
                value="500"
                min="0"
                max="5000"
              />
            </div>
            <div class="form-group">
              <label for="bypassTimeout">Timeout (seconds):</label>
              <input
                type="number"
                id="bypassTimeout"
                value="10"
                min="1"
                max="60"
              />
            </div>
            <div class="form-group">
              <label for="bypassConcurrency">Max Concurrent Requests:</label>
              <input
                type="number"
                id="bypassConcurrency"
                value="5"
                min="1"
                max="20"
              />
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" id="bypassVerboseLog" checked />
                Enable Verbose Logging
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" id="bypassAutoExport" />
                Auto-export results after test
              </label>
            </div>
          </div>

          <hr style="margin: 20px 0; border: 1px solid var(--border-color)" />

          <!-- Default Techniques Section -->
          <div class="settings-section">
            <h4 style="margin-bottom: 12px; color: var(--text-primary)">
              Default Techniques
            </h4>
            <p
              style="
                font-size: 12px;
                color: var(--text-secondary);
                margin-bottom: 8px;
              "
            >
              Select which techniques should be enabled by default:
            </p>
            <div
              style="
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
              "
            >
              <label
                ><input type="checkbox" id="defaultTechParam" checked />
                Parameter Injection</label
              >
              <label
                ><input type="checkbox" id="defaultTechHeader" checked /> Header
                Manipulation</label
              >
              <label
                ><input type="checkbox" id="defaultTechMethod" checked /> Method
                Override</label
              >
              <label
                ><input type="checkbox" id="defaultTechContent" checked />
                Content-Type</label
              >
              <label
                ><input type="checkbox" id="defaultTechAuth" checked />
                Authorization</label
              >
              <label
                ><input type="checkbox" id="defaultTechStorage" checked />
                Storage Manipulation</label
              >
              <label
                ><input type="checkbox" id="defaultTechFrontend" checked />
                Frontend Override</label
              >
              <label
                ><input type="checkbox" id="defaultTechRace" checked /> Race
                Condition</label
              >
              <label
                ><input type="checkbox" id="defaultTechEncoding" checked />
                Encoding Bypass</label
              >
              <label
                ><input type="checkbox" id="defaultTechEndpoint" checked /> Alt
                Endpoints</label
              >
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="saveBypassSettings" class="btn btn-primary">
            💾 Save Settings
          </button>
          <button id="resetBypassSettings" class="btn btn-danger btn-sm">
            🔄 Reset to Default
          </button>
          <button id="cancelBypassSettings" class="btn btn-secondary">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Import Cards Modal -->
    <div id="importCardsModal" class="modal" style="display: none">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Import Payment Cards</h3>
          <button class="modal-close" id="closeCardsModal">✕</button>
        </div>
        <div class="modal-body">
          <p>Paste your card data here (format: number|MM/YY|CVC):</p>
          <textarea
            id="cardsInput"
            rows="6"
            placeholder="5598880392588168|06/32|004
5598880392572030|11/31|157
..."
          ></textarea>
          <div class="form-group">
            <label>
              <input type="checkbox" id="replaceCardsCheck" />
              Replace existing cards (otherwise merge)
            </label>
          </div>
        </div>
        <div class="modal-footer">
          <button id="confirmImportCardsBtn" class="btn btn-primary">
            Import Cards
          </button>
          <button id="cancelImportCardsBtn" class="btn btn-secondary">
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Hidden File Inputs -->
    <input
      type="file"
      id="downloadsFileInput"
      multiple
      accept=".json"
      style="display: none"
    />
    <input
      type="file"
      id="folderInput"
      webkitdirectory
      multiple
      style="display: none"
    />
    <input
      id="cardsFileInput"
      type="file"
      accept=".md,.txt,.json"
      multiple
      style="display: none"
    />

    <script src="services/payment.js"></script>
    <script src="services/account-deletion.js"></script>
    <script src="bypass-settings.js"></script>
    <script src="bypass-handler.js"></script>
    <script src="sidepanel.js"></script>
  </body>
</html>
